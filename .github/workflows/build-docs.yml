
name: "Build docs"

jobs:
  release:
    name: "Publish to NPM"
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2.3.4

      - name: Setup Node.js environment
        uses: actions/setup-node@v2.1.2
        with:
            node-version: 14
            registry-url: https://registry.npmjs.org

      - name: Read package.json
        uses: nyaa8/package-version@v1
        with:
          path: 'package.json'

      - name: Show package version
        run: echo "${{ env.PACKAGE_VERSION }}"

      - name: Install dependencies
        run: cd src/docs && npm install

      - name: Write version number        
        uses: DamianReeves/write-file-action@v1.0
        with:
          path: src/docs/.env
          contents: |
            echo "DAISYUI_VERSION=${{ env.PACKAGE_VERSION }}"
          write-mode: overwrite

      - name: Generate
        run: cd src/docs && npm run deploy

      - name: Deploy docs to github pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./src/docs/dist
          cname: daisyui.com